layer: 6
name: testing-strategy
strategy:
  pyramid:
    - "Unit: motor de reglas/probabilidades, transiciones de estado, tensión y relaciones."
    - "Integration: APIs de creación/inicio/avance y persistencia de eventos."
    - "E2E: flujo completo setup -> simulacion -> ganador."
  stochastic_validation:
    - "Pruebas estadísticas sobre miles de simulaciones para validar distribuciones esperadas."
    - "Control por seed para escenarios deterministas de regresión."
    - "Validación específica de probabilidades 3+ participantes (1%, 0.5%, 0.25%, ...)."
    - "Property-based tests para invariantes (nunca revivir eliminados, ganador único, fin garantizado)."
  ux_quality:
    - "Pruebas de accesibilidad automatizadas en setup/simulación/final."
    - "Pruebas visuales de componentes críticos del feed narrativo."
    - "Pruebas de usabilidad para controles de velocidad, pausa, paso a paso y replay."
  contracts:
    - "Contract tests de payloads API (create/start/advance/share/replay/settings)."
  exit_criteria:
    - "Sin regresiones en reglas core de interacción."
    - "Cobertura alta en motor de simulación y contratos API críticos."
    - "Replays con misma seed y misma ruleset_version deben coincidir al 100%."
